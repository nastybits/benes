# Тесты производительности ECMAScript

Утилита позволяет запускать тесты js файлов для сравнения производительности различных функций и ECMAScript-движков. Для подключения движков используется [JSVU](https://github.com/GoogleChromeLabs/jsvu). Для запуска тестирования используется [nodeJS](https://nodejs.org/en)

Тесты запускаются без обвязки nodeJS или браузера на "чистом" движке, что позволяет исключить влияние среды на скорость выполнения.

Для запуска тестов необходимо создать папку в директории tests. В папке создать нужно количество тестируемых файлов. Итогом теста должен быть вывод времени выполнения в консоль в милисекундах.

## Установка:
Для установки требуется Node.js v18+ и JSVU
```bash
npm install jsvu -g
```
Добавить в переменную среды:
#### Linux/Mac:
```bash
export PATH="${HOME}/.jsvu/bin:${PATH}"
```

#### Windows:
Добавить папку `C:\Users\%USERNAME%\.jsvu\bin` в переменную среды `PATH`

Запустить установщик:
```bash
 jsvu
```
Пройти интерактивный диалог для установки нужных движков.

## Тесты производительности
Для запуска тестов используется nodeJS. Необходимо указать исполняемый файл теста и опциональные флаги дополнительных настроек.

```bash
node bench ./tests/arrayItemCount [-r N] [-p N] [-a]
```

Параметры запуска:
```bash
-h, --help # Вывести описание
-e, --engine # JS-движок для запуска тестов
-r, --runs # Количество прогонов
-p, --precision # Число знаков после запятой при выводе времени прогона
-a, --all # Показывать детальную информацию по каждому прогону
```

## Дополнительно
### Просмотр байткода (Только V8):

Если в проекте подключен V8, то можно вывести байт-код любого файла или функции для анализа.

```bash
# Вывести байткод файла в консоль
v8 --print-bytecode <file>
```

### Фильтры
```bash
# Вывести байткод с фильтрацией
v8 --print-bytecode <file> --print-bytecode-filter=[param] 
```

Параметры фильтров:
- `*` - Вывести байткод для всего
- `""` - Вывести байткод только для кода в глобальной области
- `-` - Вывести байткод только для кода не в глобальной области
- `doSomething` - вывести байткод только для функции "doSomething"